#include <stdio.h>
#include <stdlib.h>

int llc(unsigned char trama[]);
unsigned char num_trama = 1;

void main(void)
{

    unsigned char trama[][100] = {{//t1 ARP
                                   0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x08, 0x06, 0x00, 0x10,
                                   0x08, 0x00, 0x06, 0x04, 0x00, 0x04, 0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 0x39, 0xcb,
                                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x94, 0xcc, 0x39, 0xfe},
                                  {//t2 IP
                                   0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x08, 0x00, 0x46, 0x00,
                                   0x80, 0x42, 0x04, 0x55, 0x34, 0x11, 0x80, 0x11, 0x6b, 0xf0, 0x94, 0xcc, 0x39, 0xcb, 0x94, 0xcc,
                                   0x67, 0x02, 0xaa, 0xbb, 0xcc, 0xdd, 0x04, 0x0c, 0x00, 0x35, 0x00, 0x2e, 0x85, 0x7c, 0xe2, 0x1a,
                                   0x01, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x77, 0x77, 0x77, 0x03, 0x69,
                                   0x73, 0x63, 0x05, 0x65, 0x73, 0x63, 0x6f, 0x6d, 0x03, 0x69, 0x70, 0x6e, 0x02, 0x6d, 0x78, 0x00,
                                   0x00, 0x1c, 0x00, 0x01},
                                  {//t3 T - S
                                   0x00, 0x02, 0xb3, 0x9c, 0xdf, 0x1b, 0x00, 0x02, 0xb3, 0x9c, 0xae, 0xba, 0x00, 0x04, 0xf0, 0xf1,
                                   0x09, 0x8d, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7c, 0x9b, 0x6d},

                                  {//t4 OTRO
                                   0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x80, 0x35, 0x00, 0x01,
                                   0x08, 0x00, 0x06, 0x04, 0x00, 0x03, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x94, 0xcc, 0x3a, 0xe1,
                                   0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 0x39, 0xcb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xd8, 0xee, 0xdf, 0xb0},
                                  {//t5 T-U
                                   0x00, 0x02, 0xb3, 0x9c, 0xae, 0xba, 0x00, 0x02, 0xb3, 0x9c, 0xdf, 0x1b, 0x00, 0x03, 0xf0, 0xf0,
                                   0x53, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x43, 0x05, 0x90, 0x6d},

                                  {//T6 T - I
                                   0x00, 0x02, 0xb3, 0x9c, 0xae, 0xba, 0x00, 0x02, 0xb3, 0x9c, 0xdf, 0x1b, 0x00, 0x12, 0xf0, 0xf0,
                                   0x0a, 0x0b, 0x0e, 0x00, 0xff, 0xef, 0x14, 0x00, 0x00, 0x00, 0x28, 0x00, 0x00, 0x00, 0x7f, 0x23,
                                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x99, 0x98, 0x6d},
                                  {//t7 T-U
                                   0x00, 0x02, 0xb3, 0x9c, 0xae, 0xba, 0x00, 0x02, 0xb3, 0x9c, 0xdf, 0x1b, 0x00, 0x03, 0xf0, 0xf1,
                                   0x53, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x43, 0x05, 0x90, 0x6d},
                                  {//t8
                                   0x00, 0x02, 0xb3, 0x9c, 0xae, 0xba, 0x00, 0x02, 0xb3, 0x9c, 0xdf, 0x1b, 0x00, 0x03, 0xf0, 0xf0,
                                   0x43, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x43, 0x05, 0x90, 0x6d}};

    unsigned char i = 0;
    printf(" \n> Pacheco Castillo Isaias < \n");
    for (i = 0; i < 8; i++)
    {
        llc(trama[i]);
    }
}

int llc(unsigned char trama[])
{
    printf("\n\n\nNUM TRAMA     %d\n**********    CABECERA ETHERNET    **********", num_trama);
    printf("\nMAC DESTINO   %0.2x:%0.2x:%0.2x:%0.2x:%0.2x:%0.2x ", trama[0], trama[1], trama[2], trama[3], trama[4], trama[5]);
    printf("\nMAC ORIGEN    %0.2x:%0.2x:%0.2x:%0.2x:%0.2x:%0.2x ", trama[6], trama[7], trama[8], trama[9], trama[10], trama[11]);
    unsigned short int TOT = trama[12] << 8 | trama[13];

    if (TOT < 1500)
    {
        printf("\nTAMANIO       %d bytes \n\n**********    CABECERA LLC         **********", TOT);
        unsigned char s[][5] = {"RR", "RNR", "REJ", "SREJ"};

        //Campo de control tramas U < Command >
        unsigned char uc[][6] = {"UI", "SIM", "NR0", "SART", "UP", "--", "--", "--", "DISC", "--", "NR2", "SARME", "--", "--", "--", "SABME", "SNRM", "--", "NR1", "RSET", "--", "--", "--", "XID", "--", "--", "NR3", "SNRME"};

        //Campo de control tramas U < Response >
        unsigned char ur[][6] = {"UI", "RIM", "NR0", "DM", "--", "--", "--", "--", "RD", "--", "NR2", "--", "UA", "--", "--", "--", "--", "FRMR", "NR1", "--", "--", "--", "--", "XID", "--", "--", "NR3", "--"};

        switch (trama[16] & 3)
        {
        case 0:
        case 2: //T - I
            printf("\n T-I, N(s)= %d , N(r)= %d ", trama[16] >> 1, trama[17] >> 1);
            if (trama[17] & 1)
            {
                if (trama[15] & 1)
                    printf(", f ");
                else
                    printf(", p ");
            }
            break;
        case 1: //T - S
            printf("\n T-S, %s , N(r)= %d ", s[(trama[16] >> 2) & 3], trama[17] >> 1);
            if (trama[17] & 1)
            {
                if (trama[15] & 1)
                    printf(", f ");
                else
                    printf(", p ");
            }
            break;
        case 3: //T - U
            if (trama[16] & 16)
            {
                if (trama[15] & 1)
                    printf("\n T-U, %s , f", ur[(((trama[16] >> 2) & 3) | (trama[16] >> 3) & 28)]);
                else
                    printf("\n T-U, %s , p", uc[(((trama[16] >> 2) & 3) | (trama[16] >> 3) & 28)]);
            }
            else
                printf(" \n T-U");
            break;
        }
    }
    else if (TOT == 2048)
    {
        printf("\n IP ");
    }
    else if (TOT == 2054)
    {
        printf("\n ARP ");
    }
    else
        printf("\n OTRO ");

    num_trama++;

    return 0;
}
